<!DOCTYPE html>
<html lang="en">
    <head>
        <title>webSockets and Socket.IO</title>
        <script type="text/javascript" src="/socket.io/socket.io.js"></script> 
        <script type="text/javascript" src="assets/classes.js"></script>
        <!--The above library(/socket.io/socket.io.js) will be generated by socket.io module of server -->
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.min.js"></script> 
    </head>
    <style>
    
    	#myProgress {
    	width: 1024px;
    	background-color: grey;
		}
		#myBar {
    	width: 0px;
    	height: 30px;
    	background-color: green;
}
    
    </style>
    <body>
        <form>
             
            <div id="content"></div> <!--This is where the data from the server is added-->
 				<div id="myProgress">
  					<div id="myBar"></div>
				</div>
        </form>
 
        <script type="text/javascript">
        
				function move_progessbar(id,val) {
    				var elem = document.getElementById("myBar"); 
			    	elem.style.width = val + 'px'; 
        		
    			}         
        
        
            var socket = io.connect("/"); 
            /*Initializing the connection with the server via websockets */
            
				//recibo mensajes del servidor!!!            
            socket.on("stream",function(message){  
               
                console.log("Message from the server arrived")
                //console.log(message)
                message = JSON.parse(message);
                //console.log(message1); /*converting the data into JS object */
                //$('#content').append('<div >'+message.value_number+'</div>'); /*appending the data on the page using Jquery */
                document.getElementById("content").innerHTML = message.value_number;
                move_progessbar('myBar',message.value_number);


            });
            
            $(function(){
                $('#submit').click(function(){ /*listening to the button click using Jquery listener*/

                    //var message_local = new classes.message_object('c6_clienteweb','c4_ardu','0','hola, ardu, soy clienteweb');
                    var message_local = {
 							origin:"c6_clienteweb",
 							destination:"c4_ardu",
 							type:"0",
 							value_text:"hola ardu, soy clienteweb"
                    }
                    socket.send(JSON.stringify(message_local));

 
                    $('#message').val('');
                    //Emptying the text box value using jquery 
 
                });
            });
 
 
				function move_progessbar(id,val) {
    				var elem = document.getElementById(id); 
			    	elem.style.width = val + 'px'; 
        		
    			} 
 
 
        </script>
    </body>
</html>
