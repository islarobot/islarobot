<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Advanced Sensors</title>
        <script type="text/javascript" src="/socket.io/socket.io.js"></script> 
        <script type="text/javascript" src="assets/classes.js"></script>
        <script type="text/javascript" src="assets/functions_advancedsensors.js"></script>
        <!--The above library(/socket.io/socket.io.js) will be generated by socket.io module of server -->
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.min.js"></script> 
        
        <script>
        
			var values_items = []

			
			 for (var i = 0;i<8;i++) {
			 	
			 	values_items.push({min:0, max:255, param:"",state:"set",id:i})
			 }       
        
        
        
        
			function get_id_from_param(param_input,vl_array){
			
			 for (var i = 0;i<8;i++) {
			
			if (vl_array[i].param == param_input) {
				
				return vl_array[i].id
				
			}			
			
			}
			return -1
			}

			function hide_fields_show_values(id,vl)
			{
			document.getElementById("min"+id).style.display='none';
			document.getElementById("max"+id).style.display='none';
			document.getElementById("param"+id).style.display='none';
			document.getElementById("setvalues_button"+id).innerText="Reset";		
			
			  document.getElementById('minlabel'+id).innerHTML = vl.min;
			  document.getElementById('maxlabel'+id).innerHTML = vl.max;
			  document.getElementById('paramlabel'+id).innerHTML = vl.param;
			  


			}
			
			function show_fields_hide_values(id,vl)
			{
			document.getElementById("min"+id).style.display='initial';
			document.getElementById("max"+id).style.display='initial';
			document.getElementById("param"+id).style.display='initial';
			document.getElementById("setvalues_button"+id).innerText="Set Values";		
			
			  document.getElementById('minlabel'+id).innerHTML = '';
			  document.getElementById('maxlabel'+id).innerHTML = '';
			  document.getElementById('paramlabel'+id).innerHTML = '';
			  
			  document.getElementById('min'+id).value = vl.min;
			  document.getElementById('max'+id).value = vl.max;
			  document.getElementById('param'+id).value = vl.param;


			}
        
			function press_button(id,vl){
			
			if (vl.state == "set") {
				
			
			
			var min_local = document.getElementById("min"+id).value;
			

			
			vl.min = min_local		
			var max_local = document.getElementById("max"+id).value;
			vl.max = max_local	
			var param_local = document.getElementById("param"+id).value;
			vl.param = param_local	
			
			hide_fields_show_values(id,vl)
			vl.state = "reset";
			
			}else {
				
			show_fields_hide_values(id,vl);	
			vl.state = "set";
				
			}
			}      
			
									  
        
        </script>
    </head>
    
        <style>
    
    	.classProgress {
    	width: 100%;
    	background-color: grey;
		}
		.classBar {
    	width: 0px;
    	height: 30px;
    	background-color: green;
}
    
    </style>
    
    
    <body>
    

		
	
		
		<button onclick="press_button(0,values_items[0])" id="setvalues_button0">Set values</button>
		
		Min Value:&nbsp;<label id="minlabel0"></label><input type="text" id="min0" size="3">
		Max Value:&nbsp;<label id="maxlabel0"></label><input type="text" id="max0" size="3">
		Parameter code:&nbsp;<label id="paramlabel0"></label><input type="text" id="param0" size="3"> 
		

		<canvas style="border:1px solid #000000;" id="myCanvas0" ></canvas>
		<canvas style="border:1px solid #000000;" id="myCanvas1" ></canvas>
		<canvas style="border:1px solid #000000;" id="myCanvas2" ></canvas>
		
		
		

		

				
		


    </body>
    
	<script type="text/javascript">
	
		function move_progessbar(id,val) {
    				var elem = document.getElementById(id); 
			    	elem.style.width = val + 'px'; 
        		
    			}         
        
        
            var socket = io.connect("/"); 
            /*Initializing the connection with the server via websockets */
            
				//recibo mensajes del servidor!!!            
            socket.on("stream",function(message){  
               


                message = JSON.parse(message);
					
					
					//get id
					idparam = get_id_from_param(message.param,values_items)   
					
					if (idparam != -1) {
					
					//console.log(message1); /*converting the data into JS object */
                //$('#content').append('<div >'+message.value_number+'</div>'); /*appending the data on the page using Jquery */
                document.getElementById("content"+idparam).innerHTML = message.value_number;
                move_progessbar('bar'+idparam,message.value_number,values_items[idparam].min, values_items[idparam].max);
						
					}             
                
                
  


            });
            
            $(function(){
                $('#submit').click(function(){ /*listening to the button click using Jquery listener*/

                    //var message_local = new classes.message_object('c6_clienteweb','c4_ardu','0','hola, ardu, soy clienteweb');
                    var message_local = {
 							origin:"c6_clienteweb",
 							destination:"c4_ardu",
 							type:"0",
 							value_text:"hola ardu, soy clienteweb"
                    }
                    socket.send(JSON.stringify(message_local));

 
                    $('#message').val('');
                    //Emptying the text box value using jquery 
 
                });
            });
 
 
				function move_progessbar(id,val,min,max) {
    				var elem = document.getElementById(id); 
    				var output_value = (val-min) * (100) / (max - min)
			    	elem.style.width = output_value + '%'; 
        		
    			} 	
	
	
	
//canvas


	

	
  	var angledegc = 10;
	var xc = 260;
   var yc = 260;
	var zc = 80;
	var widthc = 520;
	var heightc = 520;
	
  	var angledeg2 = 10;
	var x2 = -1100;
   var y2 = 260;
	var z2 = 80;
	var width2 = 1250;
	var height2 = 520;
	
  	//var angledeg = 10;
	//var x = 620;
   //var y = 1450;
	//var z = 0;
	//var width = 1250;
	//var height = 220;
	
	var angledeg1 = 10;
	var x1 = 620;
   var y1 = 1450;
	var z1 = 0;
	var width1 = 1250;
	var height1 = 220;
	

	//setInterval(loopangle, 100);
	drawmarcas_generic('myCanvas0', 620, 1450, 1250, 310, 335, 25, 1400, 10, 15, 12, 1);
	//drawmarcas_generic('myCanvas1', 620, 1450, 1250, 310, 335, 25, 1400, 10, 15, 12, 1);
	drawmarcas_generic('myCanvas2', -1000, 650, 600, 1250, 65, 115, 1400, 10, 15, 12, 1);
	//setInterval(loopangle1, 100);
	//setInterval(loopangle2, 100);
	//setInterval(loopanglec, 100);
	//setanglearrow(a,x,y);
	//loopangle();
	//drawarrow();
	
	
	
	
	
	</script>    
    
</html>
