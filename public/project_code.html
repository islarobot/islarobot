<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Active Project</title>
        <script type="text/javascript" src="/socket.io/socket.io.js"></script> 
        <script type="text/javascript" src="assets/classes.js"></script>
        <script type="text/javascript" src="assets/functions_main.js"></script>
        <!--The above library(/socket.io/socket.io.js) will be generated by socket.io module of server -->
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.min.js"></script> 
    </head>
    
    
    <script type="text/javascript">
    
    			var text_code;
    
            var socket = io.connect("/"); 

				//solicito estado
				
				socket.emit('request_state','');
			
				//solicito proyecto activo
				
				socket.emit('request_active_project_code','');


				socket.on("state",function(message){  
               


            message = JSON.parse(message)
                
            });  
  
				//recibo proyecto activo
				socket.on("active_project_code",function(message){  
               
				message = JSON.parse(message)
            
				
            
				if (message.okcode == 'jsonnoencontrada' || message.okcode == 'codenoencontrada') {

					if (message.okcode == 'jsonnoencontrada') {
					alert('JSON project file not found')	
					}else {
						alert('Arduino code file not found')
					}
										
					
				}else {
					
				document.getElementById('text1').value = '';
				document.getElementById('text1').value = message.text;
				
				}
			
            }); 
            
            //buttons
            
				function updatearduinoclick()
				{
				text = document.getElementById('text1').value
				socket.emit('update_arduino',text);
				}

   
   

   
        </script>
    
    <body>
    <form>
             
            

            <div id="content"></div> <!--This is where the data from the server is added-->
 
    </form>
	<table>
	
	<tr><td>
		<textarea name="Text1" cols="100" rows="40" id="text1"	></textarea>
	</td><td>
	<table>
	<tr>
	<td>
	<button type="button" id="updatearduino" onclick="updatearduinoclick()">Update Arduino</button>
	</td>
	</tr>	
	<tr>
	<td>
	<button type="button" id="save">Save</button> &nbsp &nbspFile Name: &nbsp<input type="text" id="lname">
	</td>
	</tr>
	
	<tr>
	<td>
	<button type="button" id="loadoriginal">Load original</button>
	</td>
	</tr>
	</table>
	
	</td></td></tr>
	</table>


    </body>
</html>